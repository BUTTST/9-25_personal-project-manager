---
globs: app/components/**/*.tsx
---

# React 元件模式

## 元件結構

### 檔案組織

元件按功能分類：
- `/admin` - 管理後台元件
- `/auth` - 驗證相關元件
- `/project` - 專案展示元件
- `/ui` - 通用 UI 元件
- `/layout` - 版面配置元件

### 元件命名

- 使用 PascalCase：`ProjectCard.tsx`
- 檔案名與元件名一致：`export function ProjectCard()`
- 介面型別：`ProjectCardProps`

## 客戶端元件

所有需要互動的元件必須標記 `'use client'`：

```typescript
'use client';

import { useState } from 'react';

export function ComponentName() {
  // 元件邏輯
}
```

## Props 型別定義

```typescript
import { Project } from '@/types';

interface ComponentProps {
  project: Project;
  isAdmin?: boolean;
  onUpdate?: (project: Project) => void;
}

export function Component({ project, isAdmin = false, onUpdate }: ComponentProps) {
  // 元件邏輯
}
```

## 狀態管理

### 本地狀態

使用 `useState` 管理元件內部狀態：

```typescript
const [isOpen, setIsOpen] = useState(false);
const [data, setData] = useState<Project[]>([]);
```

### 同步外部 Props

使用 `useEffect` 同步外部 props 變化：

```typescript
useEffect(() => {
  setLocalState(propValue);
}, [propValue]);
```

## 事件處理

### 非同步操作

```typescript
const handleSubmit = async (e: React.FormEvent) => {
  e.preventDefault();
  
  try {
    const response = await fetch('/api/endpoint', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-admin-password': getRememberedPassword() || '',
      },
      body: JSON.stringify(data),
    });
    
    if (!response.ok) {
      throw new Error('操作失敗');
    }
    
    const result = await response.json();
    // 處理成功結果
  } catch (error) {
    console.error('Error:', error);
    // 顯示錯誤訊息
  }
};
```

## 樣式類別

使用 Tailwind CSS 和 `clsx` 動態組合類別：

```typescript
import clsx from 'clsx';

<div className={clsx(
  'base-classes',
  condition && 'conditional-classes',
  {
    'object-classes': booleanCondition,
  }
)}>
```

## 圖標使用

使用 Heroicons：

```typescript
import { 
  StarIcon, 
  EyeIcon 
} from '@heroicons/react/24/outline';
import { 
  StarIcon as StarIconSolid 
} from '@heroicons/react/24/solid';

<StarIcon className="h-5 w-5" />
```

## 條件渲染

```typescript
{isAdmin && <AdminControls />}
{isVisible ? <Content /> : null}
{items.length > 0 && <List items={items} />}
```

## 表單處理

```typescript
const [formData, setFormData] = useState<FormData>(initialData);

const handleChange = (field: keyof FormData, value: any) => {
  setFormData(prev => ({ ...prev, [field]: value }));
};

<form onSubmit={handleSubmit}>
  <input
    value={formData.field}
    onChange={(e) => handleChange('field', e.target.value)}
  />
</form>
```

## 元件組合

優先使用組合而非繼承：

```typescript
<Card>
  <CardHeader>標題</CardHeader>
  <CardBody>內容</CardBody>
  <CardFooter>操作</CardFooter>
</Card>
```

## 效能優化

- 使用 `useMemo` 計算衍生值
- 使用 `useCallback` 記憶化回調函式
- 大型列表使用虛擬滾動或分頁
- 圖片使用 Next.js `Image` 元件

## 可訪問性

- 使用語義化 HTML
- 提供 `aria-label` 和 `aria-describedby`
- 鍵盤導航支援
- 適當的 `role` 屬性
