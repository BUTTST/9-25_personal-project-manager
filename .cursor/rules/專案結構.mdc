---
alwaysApply: false
---
# 個人專案管理器 - 專案結構

這是一個使用 Next.js 14 (App Router)、TypeScript、Tailwind CSS 和 Supabase（PostgreSQL + Storage）建立的個人專案展示與管理平台。

## 核心架構

### 目錄結構（依現況）
- [app/](mdc:app/) - Next.js App Router 根目錄
  - [api/](mdc:app/api/) - 無伺服器 API 路由
    - `projects/`：列表、CRUD、reorder
    - `auth/`：`POST /auth/login`
    - `settings/`：`GET/PUT /settings/ui-display`、`POST /settings/reset-ui`
    - `admin/`：`GET /admin/diagnose`、`POST /admin/force-init`、`POST /admin/init-data`
    - `initialize/`：已停用自動初始化的 GET 端點（僅回傳提示）
  - [components/](mdc:app/components/) - 按功能組織的 React 元件
    - `auth/`、`admin/`、`project/`、`ui/`、`layout/`
  - [lib/](mdc:app/lib/) - 工具函數與核心邏輯
    - `blob-storage.ts`、`auth.ts`、`data-safety.ts`、`sample-data.ts`、`statistics.ts`
  - [types/](mdc:app/types/) - TypeScript 類型定義
- [config/](mdc:config/) - 圖庫等設定
- [public/](mdc:public/) - 靜態資源 (圖示、圖片、單檔 HTML 範例)
- [scripts/](mdc:scripts/) - 建置與工具腳本
- 其他：`README.md`、`DEPLOYMENT_GUIDE.md`、`資料安全規則說明.md` 等

### 關鍵檔案
- [app/types/index.ts](mdc:app/types/index.ts) - `Project`、`PasswordEntry`、`AppSettings` 等核心類型定義
- [app/lib/supabase.ts](mdc:app/lib/supabase.ts) - Supabase 客戶端配置（前端 + 後端）
- [app/lib/storage.ts](mdc:app/lib/storage.ts) - Supabase Storage 操作庫（圖片管理）
- [app/lib/auth.ts](mdc:app/lib/auth.ts) - 驗證邏輯
- [app/lib/data-safety.ts](mdc:app/lib/data-safety.ts) - 資料驗證工具（參考用）
- [app/lib/statistics.ts](mdc:app/lib/statistics.ts) - 統計資料計算
- [app/api/projects/route.ts](mdc:app/api/projects/route.ts) - 專案列表 API（GET/POST）
- [app/api/images/route.ts](mdc:app/api/images/route.ts) - 圖片管理 API（上傳/列表）
- [app/api/settings/ui-display/route.ts](mdc:app/api/settings/ui-display/route.ts) - UI 自訂設定 `GET/PUT`
- [app/api/settings/reset-ui/route.ts](mdc:app/api/settings/reset-ui/route.ts) - 重置 UI 設定
- [app/api/admin/diagnose/route.ts](mdc:app/api/admin/diagnose/route.ts) - 系統診斷
- [app/api/admin/init-data/route.ts](mdc:app/api/admin/init-data/route.ts) - 安全初始化
- [package.json](mdc:package.json) - 依賴項與腳本
- [tsconfig.json](mdc:tsconfig.json) - TypeScript 設定與路徑別名

## 路徑別名
使用已設定的路徑別名：
- `@/*` 對應 `./app/*`
- `@/components/*` 對應 `./app/components/*`
- `@/lib/*` 對應 `./app/lib/*`
- `@/types/*` 對應 `./app/types/*`

範例： `import { Project } from '@/types'`

## 技術棧
- **框架**: Next.js 14 (App Router)
- **語言**: TypeScript
- **樣式**: Tailwind CSS 與自訂設計系統
- **圖示**: Heroicons v2
- **資料庫**: Supabase PostgreSQL (專案、密碼、設定)
- **儲存**: Supabase Storage (圖片上傳)
- **部署**: Vercel

## 功能區域
1. **訪客模式**: 公開專案瀏覽，支援搜尋、篩選與統計
2. **管理員模式**: 完整的 CRUD 操作、密碼管理、UI 自訂
3. **驗證**: 基於密碼的管理員驗證與會話管理
4. **UI 自訂**: 拖放篩選器/統計、可見性控制
5. **主題支援**: 淺色/深色模式自動偵測

## 資料流
- 所有持久性資料儲存於 Supabase PostgreSQL
- 圖片儲存於 Supabase Storage（CDN 加速）
- API 路由使用 `supabaseAdmin` 處理需管理員驗證的 CRUD 操作
- 前端使用 `supabase` 讀取公開資料（受 RLS 限制）
- 客戶端元件管理本地狀態並與 API 同步
- 伺服器元件擷取資料進行初始渲染

備註：
- RLS 政策自動限制前端只能讀取 `hidden = false` 的專案
- `passwords` 表完全禁止前端訪問
- `developerNote` 僅在管理員模式下顯示