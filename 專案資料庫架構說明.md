# 專案資料庫架構說明

> 📅 更新日期：2025-11-07  
> 🎯 目的：快速了解專案用途、資料庫結構及備份位置

---

## 📦 專案用途

**個人專案展示平台** - 用於管理和展示個人作品集的網站

- **訪客**：瀏覽專案、搜尋、篩選、查看詳細資訊
- **管理員**：線上編輯專案、上傳圖片、自訂介面配置
- **技術**：Next.js + TypeScript + Supabase + Vercel

---

## 🗄️ 資料庫架構

使用 **Supabase**（PostgreSQL 雲端資料庫）

```
Supabase 專案
├── Database（資料庫）
│   ├── projects（專案資料）
│   ├── settings（系統設定）
│   └── image_metadata（圖片元數據）
│
└── Storage（檔案儲存）
    └── project-images（圖片檔案）
```

---

## 📊 各資料表用途與備份

### 1️⃣ projects（專案資料表）

#### 📝 用途
儲存所有專案的完整資訊，是整個平台的核心資料表。

**包含內容**：
- 專案名稱、說明、類別、狀態
- GitHub/Vercel/部署連結
- 各種註解（公開、開發者）
- 圖片預覽設定
- 可見性控制
- 排序和精選設定

#### 💾 備份位置

**線上備份**：
- 位置：Supabase 控制台 → Table Editor → `projects`
- 自動備份：每日自動（保留 7 天）
- 查看：Database → Backups

**手動備份**：
- 匯出格式：JSON 或 SQL
- 建議頻率：**每週一次**
- 存放位置：`本地備份/YYYY-MM-DD_projects.json`

**⚠️ 重要性：★★★★★**（最重要的資料）

---

### 2️⃣ settings（系統設定表）

#### 📝 用途
儲存整個網站的設定，包括介面配置和預設值。

**包含內容**：
- UI 顯示配置（篩選器、統計區塊的順序和顯示）
- 預設值設定（主題、狀態等）
- 系統偏好設定

**主要設定項目**：
- `app_settings`：基本應用設定
- `ui_display`：介面顯示配置

#### 💾 備份位置

**線上備份**：
- 位置：Supabase 控制台 → Table Editor → `settings`
- 自動備份：每日自動

**手動備份**：
- 匯出格式：JSON
- 建議頻率：**每月一次**（或修改後立即備份）
- 存放位置：`本地備份/YYYY-MM-DD_settings.json`

**⚠️ 重要性：★★★★**（遺失會影響介面顯示）

---

### 3️⃣ image_metadata（圖片元數據表）

#### 📝 用途
解決 Supabase 不支援中文檔名的問題，記錄「顯示名稱」和「實際儲存名稱」的對應關係。

**工作方式**：
- 上傳中文檔名圖片時，自動轉換為英文檔名儲存
- 此表記錄原始中文檔名，讓使用者看到正確的檔名
- 例如：`專案截圖.png` 實際儲存為 `image_abc123.png`

#### 💾 備份位置

**線上備份**：
- 位置：Supabase 控制台 → Table Editor → `image_metadata`
- 自動備份：每日自動

**手動備份**：
- 匯出格式：JSON
- 建議頻率：**每月一次**
- 存放位置：`本地備份/YYYY-MM-DD_image_metadata.json`

**⚠️ 重要性：★★★**（遺失會導致中文檔名無法顯示）

---

### 4️⃣ project-images（圖片儲存桶）

#### 📝 用途
儲存所有專案的截圖、預覽圖等圖片檔案。

**特性**：
- 公開存取（任何人都可以看圖片）
- 只有管理員可以上傳/刪除
- 自動 CDN 加速

#### 💾 備份位置

**線上備份**：
- 位置：Supabase 控制台 → Storage → `project-images`
- 自動備份：Supabase 自動備份

**手動備份**：
- 下載方式：在 Storage 介面逐一下載，或使用批量下載腳本
- 建議頻率：**每月一次**
- 存放位置：`本地備份/images/`（存放所有圖片）

**⚠️ 重要性：★★★★**（遺失會導致專案圖片無法顯示）

---

## 💾 快速備份指南

### 📍 自動備份

Supabase 提供**每日自動備份**，保留 7 天。

**查看位置**：
1. 登入 [Supabase 控制台](https://supabase.com/dashboard)
2. 選擇專案
3. 左側選單 → `Database` → `Backups`

**恢復方法**：
- 使用 Point-in-Time Recovery（時間點恢復）
- 可回滾到任意時間點

---

### 🔧 手動備份

#### 方法 1：從 Supabase 匯出（建議）

**資料表備份**：
1. 進入 `Table Editor`
2. 選擇資料表
3. 點擊 `Export` → 選擇 `JSON` 或 `SQL`
4. 儲存到：`本地備份/2025-11-07_[表名].json`

**圖片備份**：
1. 進入 `Storage` → `project-images`
2. 選擇檔案 → 點擊 `Download`
3. 儲存到：`本地備份/images/`

#### 方法 2：建議的備份頻率

| 資料 | 頻率 | 重要性 |
|-----|------|--------|
| projects | 每週 | ★★★★★ |
| settings | 每月 | ★★★★ |
| image_metadata | 每月 | ★★★ |
| 圖片檔案 | 每月 | ★★★★ |

---

### 🔄 緊急恢復

**資料誤刪**：
- 使用 Supabase 的 Backups 功能恢復
- 或從本地備份檔案重新匯入

**圖片遺失**：
- 從 `本地備份/images/` 重新上傳

---

### 📁 本地備份資料夾結構

```
本地備份/
├── 2025-11-07/
│   ├── projects.json
│   ├── settings.json
│   ├── image_metadata.json
│   └── images/
│       ├── screenshot_001.png
│       └── ...
└── 2025-10-28/
    └── ...
```

**⚠️ 重要提醒**：
- 將 `本地備份/` 加入 `.gitignore`（不要提交到 Git）
- 環境變數另外備份到密碼管理器

---

## 📍 資料位置快速參考

### 線上位置（Supabase 控制台）

| 資料類型 | 路徑 |
|---------|------|
| Projects 資料 | Table Editor → `projects` |
| Settings 資料 | Table Editor → `settings` |
| Image_metadata | Table Editor → `image_metadata` |
| 圖片檔案 | Storage → `project-images` |
| 自動備份 | Database → Backups |

### 本地位置

| 資料類型 | 路徑 |
|---------|------|
| 手動備份 | `本地備份/` |
| 圖片備份 | `本地備份/images/` |
| 資料表結構 | `supabase/migrations/` |

---

## 🔗 重要連結

- **Supabase 控制台**：https://supabase.com/dashboard/project/cfsseikonkwfwkhsiavm
- **Vercel 控制台**：https://vercel.com/titans-projects-0ee27614/9-25-personal-project-manager
- **線上網站**：https://9-25-personal-project-manager.vercel.app/

---

## 📝 常見問題

**Q：如何查看線上資料？**  
A：登入 Supabase 控制台 → Table Editor → 選擇資料表

**Q：如何匯出資料？**  
A：Table Editor → 選擇表 → 右上角 `Export`

**Q：如何恢復誤刪的資料？**  
A：Database → Backups → 選擇時間點 → Restore

**Q：如何下載圖片？**  
A：Storage → project-images → 選擇檔案 → Download

---

**文檔更新日期**：2025-11-07  
**資料庫版本**：v2.0（Supabase）


