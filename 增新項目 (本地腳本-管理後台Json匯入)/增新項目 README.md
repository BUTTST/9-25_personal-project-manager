# 增新項目工具包

> 🚀 提供兩種批量添加專案的方式：**本地腳本（增量）** 和 **後台匯入（覆蓋）**

---

## 📂 檔案說明

| 檔案名稱 | 用途 | 資料處理方式 |
|---------|------|-------------|
| `批量添加範例腳本.js` | 本地執行的批量添加工具 | **增量式**（只添加新專案，自動去重） |
| `本地腳本-專案數據範本.json` | 本地腳本的數據來源 | 只包含 `projects` 陣列 |
| `後台JSON匯入-完整備份範本.json` | 管理後台匯入的數據範本 | **覆蓋式**（完全替換所有資料） |

---

## 🎯 選擇適合的方式

### 方式 1：本地腳本（推薦用於批量添加）

**適用場景**：
- ✅ 需要批量添加新專案
- ✅ 不想影響現有資料
- ✅ 確保不會重複添加

**特點**：
- 🔄 **增量式**：只添加新的，不影響舊的
- 🔍 **自動去重**：根據專案名稱過濾重複
- 📊 **詳細進度**：實時顯示上傳狀態
- ✅ **安全可靠**：不會誤刪或覆蓋資料

**使用檔案**：
- `批量添加範例腳本.js`
- `本地腳本-專案數據範本.json`

---

### 方式 2：後台 JSON 匯入（用於系統還原）

**適用場景**：
- 🔄 從備份檔案還原整個系統
- 📦 完整遷移資料到新環境
- ⚠️ 需要完全覆蓋現有資料

**特點**：
- 🔒 **覆蓋式**：會替換所有現有資料
- 🛡️ **雙重確認**：需要輸入確認文字
- 📊 **數據統計**：顯示覆蓋前後對比
- ⚠️ **高風險**：務必先備份

**使用檔案**：
- `後台JSON匯入-完整備份範本.json`
- 在「管理後台 → 系統設定 → 匯入資料」使用

---

## ⚡ 快速開始

### 方式 1：使用本地腳本批量添加

#### 步驟 1：配置腳本

編輯 `批量添加範例腳本.js`，修改配置：

```javascript
const CONFIG = {
  API_URL: 'https://你的域名.vercel.app/api/projects',
  ADMIN_PASSWORD: '你的管理員密碼',
};
```

#### 步驟 2：準備數據

編輯 `本地腳本-專案數據範本.json`，填入你的專案：

```json
{
  "projects": [
    {
      "dateAndFileName": "10-25 我的專案",
      "description": "［重要］專案說明",
      "category": "important",
      "status": "in-progress",
      ...
    }
  ]
}
```

#### 步驟 3：執行腳本

在此資料夾開啟終端機，執行：

```bash
node 批量添加範例腳本.js
```

---

### 方式 2：使用後台 JSON 匯入

#### 步驟 1：準備完整備份檔案

參考 `後台JSON匯入-完整備份範本.json` 的格式，準備你的完整備份資料。

**或者**，從管理後台「匯出資料」下載現有備份。

#### 步驟 2：進入管理後台

1. 登入管理後台
2. 進入「系統設定」頁籤
3. 找到「匯入資料」按鈕

#### 步驟 3：匯入數據

1. 點擊「匯入資料」
2. 輸入確認文字：`我確定要完全覆蓋資料庫`
3. 選擇備份檔案
4. 確認數據統計
5. 完成匯入

---

## 📊 專案欄位完整說明

### 必填欄位

| 欄位 | 說明 | 範例 |
|------|------|------|
| `dateAndFileName` | 日期 + 專案名稱 | `"10-25 我的專案"` |
| `description` | 專案說明 | `"［重要］這是說明"` |
| `category` | 專案分類 | `"important"` / `"secondary"` / `"practice"` / `"single-doc"` / `"completed"` / `"abandoned"` |
| `status` | 專案狀態 | `"in-progress"` / `"on-hold"` / `"long-term"` / `"completed"` / `"discarded"` |

### 選填欄位

| 欄位 | 說明 | 範例 |
|------|------|------|
| `github` | GitHub 連結 | `"https://github.com/..."` |
| `vercel` | Vercel 連結 | `"https://....vercel.app"` |
| `deployment` | 其他部署連結 | `"https://..."` |
| `path` | 本地路徑 | `"E:\\專案\\..."` |
| `statusNote` | 狀態備註 | `"正在開發中"` |
| `publicNote` | 公開註解 | `"這會顯示在前端"` |
| `developerNote` | 開發者註解 | `"這只有管理員看得到"` |
| `featured` | 是否精選 | `true` / `false` |
| `hidden` | 是否隱藏 | `true` / `false` |

### 進階欄位

#### 圖片預覽（imagePreviews）

```json
"imagePreviews": [
  {
    "id": "img-1",
    "title": "主畫面",
    "description": "應用程式主介面",
    "src": "/screenshots/main.png",
    "thumbnail": "/screenshots/main-thumb.png"
  }
]
```

- `imagePreviewMode`: `"single"` 或 `"grid"`（顯示模式）

#### 自訂資訊區塊（customInfoSections）

```json
"customInfoSections": [
  {
    "id": "custom-1",
    "title": "技術棧",
    "type": "text",
    "content": "Next.js, TypeScript",
    "visible": true
  },
  {
    "id": "custom-2",
    "title": "文檔連結",
    "type": "url",
    "content": "https://docs.example.com",
    "visible": true
  }
]
```

- `type`: `"text"` 或 `"url"`

#### 單檔專案元數據（documentMeta）

```json
"documentMeta": {
  "filePath": "/單檔-獨立頁面/tool.html",
  "title": "工具名稱",
  "description": "工具說明",
  "fileSize": "120 KB",
  "openBehavior": "new-tab",
  "tags": ["工具", "HTML"]
}
```

- `openBehavior`: `"current-tab"` / `"new-tab"` / `"modal"`

---

## 🔍 本地腳本去重機制

腳本會自動進行以下處理：

1. **獲取現有專案**：從資料庫讀取所有專案列表
2. **比對名稱**：根據 `dateAndFileName` 比對
3. **自動跳過**：已存在的專案自動跳過
4. **只傳新的**：只上傳不存在的專案

**範例**：

```
資料庫現有: [A, B, C]
準備添加:   [B, C, D, E]
↓ 去重後
實際上傳:   [D, E]
最終結果:   [A, B, C, D, E]
```

---

## ⚠️ 重要注意事項

### 1. 兩種方式的區別

| 特性 | 本地腳本 | 後台 JSON 匯入 |
|------|----------|---------------|
| 資料處理 | 增量添加 | 完全覆蓋 |
| 去重機制 | ✅ 自動去重 | ❌ 會覆蓋所有 |
| 安全性 | 更安全 | 高風險 |
| 使用時機 | 批量添加新專案 | 系統還原 |
| 確認機制 | 3 秒倒數 | 雙重確認 |

### 2. 密碼安全

- ⚠️ **不要**將包含密碼的腳本上傳到 Git
- ✅ 已在 `.gitignore` 中排除腳本檔案
- ✅ 使用前先配置密碼

### 3. 執行前務必備份

**無論使用哪種方式，都建議先備份**：

1. 進入管理後台「系統設定」
2. 點擊「匯出資料」下載備份
3. 保存到安全位置
4. 確認備份成功後再執行

---

## 🐛 常見問題

### Q1: 執行本地腳本時出現「未授權訪問」

**原因**：管理員密碼不正確

**解決**：
1. 檢查 `批量添加範例腳本.js` 中的密碼
2. 確認 Vercel 環境變數的密碼設定
3. 確保兩者一致

### Q2: 後台匯入時無法點擊確認

**原因**：輸入的確認文字不正確

**解決**：必須完整輸入「我確定要完全覆蓋資料庫」（包含標點符號）

### Q3: 本地腳本找不到數據檔案

**原因**：檔案名稱或路徑不正確

**解決**：
1. 確認 `本地腳本-專案數據範本.json` 在同一資料夾
2. 檢查腳本中的 `DATA_FILE` 設定
3. 確認檔案名稱正確（包含繁體中文）

### Q4: 想更新已存在的專案

**答**：
- 本地腳本：無法更新，只能添加新的
- 後台匯入：會完全覆蓋，可以更新

建議使用管理後台的編輯功能更新單一專案。

---

## 📚 進階使用

### 本地開發環境測試

修改 API_URL：

```javascript
API_URL: 'http://localhost:3000/api/projects',
```

### 批量處理大量專案

建議分批處理（每次 20-30 個專案）：

1. 將專案分批放入數據檔案
2. 執行腳本上傳第一批
3. 確認成功後繼續下一批

### 自訂延遲時間

如果遇到 API 限流，增加延遲：

```javascript
// 在腳本中找到這行
await new Promise(resolve => setTimeout(resolve, 300));

// 改為 1 秒
await new Promise(resolve => setTimeout(resolve, 1000));
```

---

## 📞 需要幫助？

遇到問題時：

1. 檢查終端機的錯誤訊息
2. 參考上方的常見問題
3. 檢查 Vercel 部署日誌
4. 確認資料格式是否正確

---

## 📋 功能對照表

| 需求 | 推薦方式 | 理由 |
|------|----------|------|
| 批量添加新專案 | 本地腳本 | 安全、去重、不影響現有資料 |
| 從備份還原系統 | 後台 JSON 匯入 | 完整還原所有設定和資料 |
| 更新單一專案 | 管理後台編輯功能 | 精確控制，不影響其他專案 |
| 遷移到新環境 | 後台 JSON 匯入 | 一次性完整遷移 |

---

**版本**：v1.0  
**最後更新**：2024-10-25  
**相容系統版本**：v1.0.0+
